{% extends 'sitioweb/base.html' %} 
{% load i18n %} {% block title %}{{categoria.nombre}} | Joaco{% endblock %} {% block content %}
<div class="row pt-4">
  <div class="col-12 mb-5">
    <h1 class="display-4 fw-bold text-uppercase">{{categoria.nombre}}</h1>
  </div>

  <div class="col-12">
    <div class="row g-4">
      <div class="container mb-5">
        <div
          class="d-flex justify-content-between align-items-center w-100 pb-3 border-bottom border-secondary border-opacity-25"
        >
          <ul class="nav nav-pills custom-pills">
            <li class="nav-item">
              <a
                class="nav-link {% if not sub_cat_actual %}active{% endif %}"
                href="?orden={{ orden_actual|default:'fecha' }}"
              >
                {% trans "Todos" %}
              </a>
            </li>
            {% for valor, etiqueta in sub_categorias %}
            <li class="nav-item">
              <a
                class="nav-link {% if sub_cat_actual == valor %}active{% endif %}"
                href="?sub_cat={{ valor }}&orden={{ orden_actual|default:'fecha' }}"
              >
                {{ etiqueta }}
              </a>
            </li>
            {% endfor %}
          </ul>

          <div class="d-flex btn-group-retro">
            <a
              href="?sub_cat={{ sub_cat_actual|default:'' }}&orden=fecha"
              class="btn btn-retro {% if orden_actual != 'alfabetico' %}active-retro{% endif %}"
            >
              {% trans "Más recientes" %}
            </a>
            <a
              href="?sub_cat={{ sub_cat_actual|default:'' }}&orden=alfabetico"
              class="btn btn-retro {% if orden_actual == 'alfabetico' %}active-retro{% endif %}"
            >
              {% trans "A-Z" %}
            </a>
          </div>
        </div>
      </div>
      {% for proyecto in proyectos %}
      <div class="col-md-6 col-lg-4">
        <a
          href="{% url 'proyecto_detalle' proyecto.pk %}"
          class="text-decoration-none"
        >
          <div
            class="card bg-dark border-0 project-card overflow-hidden position-relative"
          >
            <div class="ratio ratio-16x9">
              <img
                src="{{ proyecto.miniatura.url }}"
                class="card-img object-fit-cover"
                alt="{{ proyecto.nombre }}"
              />
            </div>

            <div
              class="project-overlay d-flex flex-column justify-content-center align-items-center text-center p-3"
            >
              <h5 class="text-warning fw-bold mb-2">{{ proyecto.nombre }}</h5>
              {% if proyecto.tagline %}
              <div class="small text-light opacity-75 tagline-preview">
                {{ proyecto.tagline|truncatewords:10|linebreaksbr }}
              </div>
              {% endif %}
            </div>
          </div>
        </a>
      </div>
      {% empty %}
      <div class="col-12">
        <div class="alert alert-dark border-secondary text-center py-5">
          <p class="mb-0 text-secondary">
            {% trans "No hay proyectos cargados aún." %}
          </p>
        </div>
      </div>
      {% endfor %}
    </div>
  </div>
</div>

<style>
  /* Contenedor principal de la tarjeta */
  .project-card {
    cursor: pointer;
    /* Importante: el fondo de la card debe ser transparente para ver el 'tiling' de la web */
    background-color: transparent !important; 
  }

  /* La imagen del proyecto */
  .project-card img {
    transition: all 0.4s ease;
    display: block;
    z-index: 1;
  }

  /* La capa que contiene el texto */
  .project-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: transparent !important; 
    opacity: 0;
    transition: opacity 0.4s ease;
    z-index: 2;
    /* Mantenemos bordes rectos */
    border-radius: 0;
  }

  /* --- EL TRUCO ESTÁ AQUÍ --- */
  
  /* Al pasar el mouse: */
  /* 1. Mostramos el texto */
  .project-card:hover .project-overlay {
    opacity: 1;
  }

  /* 2. Hacemos que la imagen desaparezca */
  .project-card:hover img {
    opacity: 0; /* Si quieres que se vea un poquito la imagen */
    /* opacity: 0; */ /* Si quieres que desaparezca totalmente y solo se vea el tiling del fondo */
    transform: scale(1.1);
  }

  .tagline-preview {
    font-family: "Jersey 10", sans-serif;
    font-size: 1rem;
    line-height: 1.2;
    color: #ffd966 !important;
  }
  
  /* Sombra de texto para asegurar que se lea sobre el fondo pixelado */
  .project-overlay h5 {
   /*font-family: "Jersey 10", sans-serif; */
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.7);
  }
</style>
{% endblock %}
